

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Appendices &mdash; s2Dcd 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Licence" href="licence.html" />
    <link rel="prev" title="Publications" href="publications.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> s2Dcd
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="purpose.html">Code purpose</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Appendices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-s2Dcd.s2Dcd">The <code class="docutils literal notranslate"><span class="pre">s2Dcd</span></code> module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#todo">TODO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-s2Dcd.deesse">The <code class="docutils literal notranslate"><span class="pre">s2Dcd.deesse</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-s2Dcd.utili">The <code class="docutils literal notranslate"><span class="pre">s2Dcd.utili</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-s2Dcd.grid">The <code class="docutils literal notranslate"><span class="pre">s2Dcd.grid</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-s2Dcd.gslibnumpy">The <code class="docutils literal notranslate"><span class="pre">s2Dcd.gslibnumpy</span></code> module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions-and-classes">Functions and classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-s2Dcd.ext">The <code class="docutils literal notranslate"><span class="pre">s2Dcd.ext</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">s2Dcd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Appendices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="appendices">
<span id="id1"></span><h1>Appendices<a class="headerlink" href="#appendices" title="Permalink to this headline">¶</a></h1>
<p>Here some additional documentation about the <cite>Python</cite> modules used by
the <cite>s2Dcd</cite> tool.</p>
<div class="section" id="module-s2Dcd.s2Dcd">
<span id="the-s2dcd-module"></span><h2>The <code class="docutils literal notranslate"><span class="pre">s2Dcd</span></code> module<a class="headerlink" href="#module-s2Dcd.s2Dcd" title="Permalink to this headline">¶</a></h2>
<dl class="field-list">
<dt class="field-odd">license</dt>
<dd class="field-odd"><p>This file is part of s2Dcd.</p>
<p>s2Dcd is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>s2Dcd is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with s2Dcd.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
</dd>
<dt class="field-even">Purpose</dt>
<dd class="field-even"><p>A module to apply the <cite>s2Dcd</cite> multiple-point simulation approach.
At the moment it is implemented with the <cite>DeeSse</cite> MPS simulation engine,
but could be adapted easily to other MPS engines.</p>
</dd>
<dt class="field-odd">File name</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">s2Dcd.py</span></code></p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><dl class="simple">
<dt>0.9.9 , 2018-01-23 :</dt><dd><ul class="simple">
<li><p>Solved one bug that prevented simulation perpendicular
to axis <em>x</em>.</p></li>
</ul>
</dd>
<dt>0.9.8 , 2017-12-15 :</dt><dd><ul class="simple">
<li><p>Solved one but related to casting some index.</p></li>
</ul>
</dd>
<dt>0.9.6 , 2014-08-12 :</dt><dd><ul class="simple">
<li><p>Try to include the auxiliary variables treatment.</p></li>
<li><p>Changed name of the module related to the DS.</p></li>
</ul>
</dd>
<dt>0.9.5 , 2013-11-15 :</dt><dd><ul class="simple">
<li><p>Converted to Python3 with <cite>2to3</cite>.</p></li>
<li><p>Corrected a bug in the function <cite>matrioska_interval</cite>.</p></li>
<li><p>Adapted to the new version of gslibnumpy.</p></li>
</ul>
</dd>
<dt>0.9.4 , 2012-09-05 :</dt><dd><ul class="simple">
<li><p>Last version before the movement to Python3</p></li>
</ul>
</dd>
<dt>0.9.3 , 2012-09-04 :</dt><dd><ul class="simple">
<li><p>Tested on a simple case study with one thread and no
auxiliary variables.</p></li>
</ul>
</dd>
<dt>0.9.2, 2012-05-02 :</dt><dd><ul class="simple">
<li><p>Defined some variables to describe the range of integer values
that the seed should take.</p></li>
<li><p>Corrected a bug related to bad parenthesis (thank you Andrea!)</p></li>
</ul>
</dd>
<dt>0.9.1,  2012-05-02 :</dt><dd><ul class="simple">
<li><p>Added an option to better define when a problem is for categorical
variables or for continuous ones.</p></li>
<li><p>Solved a bug (forgotten to print the <cite>in</cite> file in the case
of multiple threads).</p></li>
</ul>
</dd>
<dt>0.8,  2012-04-02 :</dt><dd><ul class="simple">
<li><p>Modified some structures in order to include them in a
module containing some tools to deal with structured
grids… in order to prepare the interface to the MPDS code.</p></li>
</ul>
</dd>
<dt>0.7,  2012-02-24 :</dt><dd><ul class="simple">
<li><p>Using the variable <code class="xref py py-data docutils literal notranslate"><span class="pre">no_data</span></code> the default value for
the not yet simulated nodes can be re-defined with more
flexibility.</p></li>
</ul>
</dd>
<dt>0.6,  2012-02-23 :</dt><dd><ul class="simple">
<li><p>Added a functionality allowing to define a random seed.</p></li>
<li><p>Added a function to create a simple <em>standard</em> simulation
sequence.</p></li>
</ul>
</dd>
<dt>0.5,  2012-02-16 :</dt><dd><ul class="simple">
<li><p>added the class <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a> to  simplify notation.</p></li>
</ul>
</dd>
<dt>0.4,  2012-02-16 :</dt><dd><ul class="simple">
<li><p>cleaned up some procedures and documentation.</p></li>
</ul>
</dd>
<dt>0.3, :</dt><dd><ul class="simple">
<li><p>implemented the treatment of auxiliary variables.</p></li>
</ul>
</dd>
<dt>0.2, :</dt><dd><ul class="simple">
<li><p>some improvements…</p></li>
</ul>
</dd>
<dt>0.1, :</dt><dd><ul class="simple">
<li><p>first version.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Alessandro Comunian.</p>
</dd>
</dl>
<div class="section" id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>See the examples in the corresponding directory and the documentation
of the main functions.</p>
</div>
<div class="section" id="limitations">
<h3>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>auxiliary variables:</dt><dd><p>For the moment they are implemented only for the <code class="docutils literal notranslate"><span class="pre">implala</span></code> MPS
engine.</p>
</dd>
<dt>number of variables:</dt><dd><p><cite>MPDS</cite> can be used with only one variable.</p>
</dd>
</dl>
</div>
<div class="section" id="todo">
<h3>TODO<a class="headerlink" href="#todo" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Include the usage of auxiliary variables when using all the MPS
engines.</p></li>
<li><p>Implement all the features that can be described in the parameter
files.</p></li>
<li><p>Deal with the connection problem that can raise when the licence
cannot be verified or the connection is slow.</p></li>
<li><p>Improve the output and input format, adding for example the SGeMS
binary input/output format (look for the format in mGstat, for
example)</p></li>
<li><p>For some simulation engines (like the one based on the snesim/impala engines), 
that can store information coming from threes/lists in and external file, it can be 
useful to allow the re-use of these.</p></li>
<li><p>Add some functionality to delete all the output files created,
something like <em>DEBUG</em> or <em>VERBOSE</em> mode.</p></li>
</ul>
<dl class="function">
<dt id="s2Dcd.s2Dcd.GetWhereToAddData">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">GetWhereToAddData</code><span class="sig-paren">(</span><em class="sig-param">vtkReaderOutput</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.GetWhereToAddData" title="Permalink to this definition">¶</a></dt>
<dd><p>Get where the data file should be added into the hard data
archive.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>vtkReaderOutput:</dt><dd><p>The result of a “GetOutput()” from a
“vtkStructuredPointsReader” object.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>The axis normal to the plane where the simulation was
performed in the format character, that is <em>x</em>, <em>y</em> or <em>z</em>.</p></li>
<li><p>the “coordinate” (in the reference system of the simulation,
that is related to the “pixel” which have to be simulated in
the matrix of hard data) of the slice where the new
simulated data should be added.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is obsolete.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="s2Dcd.s2Dcd.SeqStep">
<em class="property">class </em><code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">SeqStep</code><span class="sig-paren">(</span><em class="sig-param">direct</em>, <em class="sig-param">level</em>, <em class="sig-param">param</em>, <em class="sig-param">pseudo3D=0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.SeqStep" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that contains all the information required to create a
parameters input file for the used MPS engines, that is a <em>step</em> of
the simulation sequence of the approach <cite>s2Dcd</cite>.</p>
<dl class="method">
<dt id="s2Dcd.s2Dcd.SeqStep.create_list">
<code class="sig-name descname">create_list</code><span class="sig-paren">(</span><em class="sig-param">simODS</em>, <em class="sig-param">par_template</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.SeqStep.create_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Impala to create the lists required along a given
direction.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Contains all the info concerning the simulation
domain.</p>
</dd>
<dt>par_template: class <code class="xref py py-class docutils literal notranslate"><span class="pre">impala_interface.Param</span></code>.</dt><dd><p>The parameters for creating the <em>.in</em> file for the
simulations.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>Create for each level of multigrid a list in binary format.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.s2Dcd.SeqStep.simul">
<code class="sig-name descname">simul</code><span class="sig-paren">(</span><em class="sig-param">step</em>, <em class="sig-param">step_max</em>, <em class="sig-param">hard_data</em>, <em class="sig-param">simODS</em>, <em class="sig-param">in_par</em>, <em class="sig-param">seed</em>, <em class="sig-param">rcp_lists</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.SeqStep.simul" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a MPS simulation for a simulation step of a sequence.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>step: int</dt><dd><p>The current simulation step.</p>
</dd>
<dt>step_max: int</dt><dd><p>The maximum simulation step. Note that the simulation
domain can be often filled before this step. In this
case, the simulation procedure is stopped.  Defining
this parameter smaller than the total number of
simulations expected to fill the domain can be useful
for doing some preliminar test.</p>
</dd>
<dt>hard_data: numpy array</dt><dd><p>A numpy array containig all the simulation. The value
of the global variable <code class="xref py py-data docutils literal notranslate"><span class="pre">no_data</span></code> is used in
locations not yet simulated.</p>
</dd>
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Contains all the info concerning the simulation
domain.</p>
</dd>
<dt>in_par: string or member of the class <code class="xref py py-class docutils literal notranslate"><span class="pre">Param</span></code>.</dt><dd><p>The parameters for creating the <em>.in</em> file for the
simulations.  In case it is a string: The name of the
file containing the template of the input parameters
file.  In case it is a <cite>Param</cite> object:
All the parameters readed from a template <cite>.in</cite> file
required for a MPDS simulation.  seed: instance of the
class <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code> To keep track of the
random seed and create simulations that can be
reproduced using the same seed.</p>
</dd>
<dt>rcp_lists: flag</dt><dd><p>Useful if one wants to re-compute the list at each 
simulation step. This parameter has sense only for the
<cite>Impala</cite> family of MPS simulation engines.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>Create some files required for the simulation.</p></li>
<li><p>Update the content of the numpy array <cite>hard_data</cite>
including new simulated nodes.</p></li>
</ul>
<p>If the selected section is full of hard data, simply
returns 1 without creating files and without running the
MPS simulation.  If there is an error, returns -1.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.adaptAuxVarFile">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">adaptAuxVarFile</code><span class="sig-paren">(</span><em class="sig-param">seq</em>, <em class="sig-param">simODS</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.adaptAuxVarFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the dimension in the VTK file containing the auxiliary
variable map in order to adapt it for the current 2D simulation.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>seq: object of type <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a></dt><dd><p>Contains the information related to the current simulation
step.</p>
</dd>
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Contains the dimension required to define a simulation domain.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A file containing a auxiliary variable whith dimensions
suitable for the current simulation step.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.addVtk2HdArchive">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">addVtk2HdArchive</code><span class="sig-paren">(</span><em class="sig-param">hard_data</em>, <em class="sig-param">facies</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.addVtk2HdArchive" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to add all the VTK files contained into the current
directory into an hard data archive file (that is a 3D matrix
which once filled in will be the “final” simulation).</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>hard_data: string</dt><dd><p>Name of the file which contains all the conditioning data.</p>
</dd>
<dt>facies: string</dt><dd><p>A string containing the facies which are considered.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is obsolete. It can be time consuming if a lot
of VTK files are present in the working directory.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.add_gslib_pointdata">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">add_gslib_pointdata</code><span class="sig-paren">(</span><em class="sig-param">data_files</em>, <em class="sig-param">hard_data</em>, <em class="sig-param">simODS</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.add_gslib_pointdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the hard data contained in a number of GSLIB point data files.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>files: list of strings</dt><dd><p>A number of files containing the data. Note that this must
be in a list format even if only one file is
considered. For example, you should always use a syntax
like <cite>[“file1.gslib”]</cite> even if you provide only one file.</p>
</dd>
<dt>hard_data: 3D numpy array</dt><dd><p>Where all the simulated points are stored.</p>
</dd>
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Contains all the info concerning the simulation domain.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Update the content of the array <cite>hard_data</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.add_hd">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">add_hd</code><span class="sig-paren">(</span><em class="sig-param">seq_step</em>, <em class="sig-param">new_hd</em>, <em class="sig-param">hard_data</em>, <em class="sig-param">simODS</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.add_hd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a numpy array containing the data simulated at a given
sequence step to the array that stores the simulated nodes.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>seq_step: instance of the class <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a></dt><dd><p>Information about the current simulation step.</p>
</dd>
<dt>new_hd: numpy array (2D)</dt><dd><p>The new simulated section.</p>
</dd>
<dt>hard_data: numpy array (3D)</dt><dd><p>The contained of all the simulated data.</p>
</dd>
<dt>simODS:  object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Information about the simulation grid.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Fit the content provided with <cite>new_hd</cite> into the right position
into the array <cite>hard_data</cite>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>A the moment the fact that a gslib file can contain multiple 
variables is handled with a quick and dirty trick.</p></li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.all_segms0">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">all_segms0</code><span class="sig-paren">(</span><em class="sig-param">segms</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.all_segms0" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a list of segments contains at least one segment with
length &gt; 0.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>segms:</dt><dd><p>A list of tuples representing 1D segments.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>True if all the segments contained into the list have length = 0,
False if at least one segment has a length &gt; 0.</p>
</dd>
</dl>
<p>Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">all_segms0</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_segms0</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.check_ti_file">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">check_ti_file</code><span class="sig-paren">(</span><em class="sig-param">par</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.check_ti_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a parameter file for <cite>Impala</cite> or <cite>MPDS</cite> has a name for
the TI file or not.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>par: object of type <cite>Param</cite> or <cite>Param</cite>.</p>
</dd>
<dt>Returns:</dt><dd><p>True if a TI file name is defines, false if None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.create_in_file4Impala">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">create_in_file4Impala</code><span class="sig-paren">(</span><em class="sig-param">in_par</em>, <em class="sig-param">seq_si</em>, <em class="sig-param">file_cond</em>, <em class="sig-param">file_name_sim</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.create_in_file4Impala" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a parameters input file for <em>Impala</em>. A big part of the
information is read directly from the template input file for
<em>Impala</em>.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>in_par: object of type <cite>impala_interface.Param</cite>.</dt><dd><p>All the information contained in the template file.</p>
</dd>
<dt>seq_si: object of the class <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a>.</dt><dd><p>All the informations required to create a simulation for the
current simulation step. See the class <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a>
for details.</p>
</dd>
<dt>file_cond: string or None</dt><dd><p>Name of the conditioning file, if None the simulation is
considered as non conditional.</p>
</dd>
<dt>file_name_sim: string</dt><dd><p>Name of the input paramter file for <em>Impala</em>.</p>
</dd>
<dt>seed: instance of the class <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code>, optional</dt><dd><p>To keep track of the random seed and create simulations
that can be reproduced using the same seed.  A definition
of the seed is not required when the MPS core is called
only for the generation of the lists. Therefore, in this
case the value of seed can be None, and the value of the
module variable <cite>seed_default</cite> is used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A <cite>*.in</cite> file containing the parameters for running <cite>Impala</cite>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to increase the variability of the simulations, a new
random seed is generated for each simulation file that is
created if a <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code> instance is provided with
the paramter <cite>seed</cite>. Otherwise, the value of the global
variable <cite>seed_default</cite> is used.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.create_in_file4MPDS">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">create_in_file4MPDS</code><span class="sig-paren">(</span><em class="sig-param">in_par</em>, <em class="sig-param">seq_si</em>, <em class="sig-param">file_cond</em>, <em class="sig-param">file_name_sim</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.create_in_file4MPDS" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a parameters input file for <cite>MPDS</cite> adapted to the current
simulation step and the current conditioning data file.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>in_par: object of type <cite>ds_interface.Param</cite>.</dt><dd><p>All the info about the in template file.</p>
</dd>
<dt>seq_si: object of the class <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a>.</dt><dd><p>(sequence stepA info) All the informations required to
create a simulation for the current simulation step. See
the class <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a> for details.</p>
</dd>
<dt>file_cond: string or None</dt><dd><p>Name of the conditioning file, if None the simulation is
considered as non conditional.</p>
</dd>
<dt>file_name_sim: string</dt><dd><p>Name of the input paramter file for <cite>MPDS</cite>.</p>
</dd>
<dt>seed: instance of the class <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code>, optional</dt><dd><p>To keep track of the random seed and create simulations
that can be reproduced using the same seed.  A definition
of the seed is not required when the MPS core is called
only for the generation of the lists. Therefore, in this
case the value of seed can be None, and the value of the
module variable <cite>seed_default</cite> is used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A <cite>*.in</cite> file for the current simulation.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to increase the variability of the simulations, a new
random seed is generated for each simulation file that is
created if a <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code> instance is provided with
the paramter <cite>seed</cite>. Otherwise, the value of the global
variable <cite>seed_default</cite> is used.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.create_lists">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">create_lists</code><span class="sig-paren">(</span><em class="sig-param">simODS</em>, <em class="sig-param">par_template</em>, <em class="sig-param">par_Xnorm</em>, <em class="sig-param">par_Ynorm</em>, <em class="sig-param">par_Znorm</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.create_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the lists which will be used by <em>Impala</em> for the simulation.</p>
<p>This preliminary step is required and allows use <em>Impala</em> to
compute the MPS list only once, before starting the simulation,
and therefore save computing resources.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Contains all the info concerning the simulation domain.</p>
</dd>
<dt>par_template: impala_interface.Param</dt><dd><p>All the information contained in the <cite>template.in</cite> file.</p>
</dd>
<dt>par_Xnorm: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">impala_interface.Param</span></code></dt><dd><p>Information about the <em>Impala</em> parameters normal to the
direction <em>x</em>.</p>
</dd>
<dt>par_Ynorm: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">impala_interface.Param</span></code></dt><dd><p>Information about the <em>Impala</em> parameters normal to the
direction <em>y</em>.</p>
</dd>
<dt>par_Znorm: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">impala_interface.Param</span></code></dt><dd><p>Information about the <em>Impala</em> parameters normal to the
direction <em>z</em>.</p>
</dd>
</dl>
</dd>
<dt>Returns: </dt><dd><p>A list (in binary format) for each multi-grid level and for
each simulation direction is created in the current directory
running <em>Impala</em>.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.create_seq">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">create_seq</code><span class="sig-paren">(</span><em class="sig-param">simODS</em>, <em class="sig-param">par_Xnorm</em>, <em class="sig-param">par_Ynorm</em>, <em class="sig-param">par_Znorm</em>, <em class="sig-param">pseudo3D=0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.create_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a simple simulation sequence.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>simODS: grid definition</dt><dd><p>Information about the simulation grid.</p>
</dd>
<dt>par_Xnorm, par_Ynorm, par_Znorm: <code class="xref py py-class docutils literal notranslate"><span class="pre">Param</span></code></dt><dd><p>Information related to the simulation directions.
See the class documentation for details.</p>
</dd>
<dt>pseudo3D: integer (default=0)</dt><dd><p>Set or not the “pseudo3D” simulation option when this
value is &gt;0.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>A sequence of <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a> objects, with all the
information needed to run each simulation step.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function provide the <strong>basic</strong> definition for a
simulation sequence when the simulation domain is quite
simple, like for example when it has a “box” shape (the sizes
of the simulation grid along the directions <em>x</em>, <em>y</em> and <em>z</em>
are comparable).  If the dimensions along the different axes
of your simulation domain are not comparable, you can for
example explicitly add some customized simulation steps to
improve the quality of the results. There is one example of
this in the examples directory.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.file_name_sec">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">file_name_sec</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">axe</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.file_name_sec" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of a file which will be used to store a section
of the input parameter <cite>file_name</cite>.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_name: string</dt><dd><p>The name of the input file which should be sectioned</p>
</dd>
<dt>axe: string in (‘x’,’y’,’z’)</dt><dd><p>The axis perpendicular to the section.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is supposed that the sectioned file lies in the current 
directory. Therefore, the path in the name of the input
file name will be dropped.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.matrioska_interval">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">matrioska_interval</code><span class="sig-paren">(</span><em class="sig-param">points_nb</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.matrioska_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a “spreaded” list of integers.</p>
<p>This function is useful to provide a simulation sequence along one
axis that allows, in priciple, to obtain as much as intersections
as possible along the other directions.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>points_nb: integer</dt><dd><p>The number of points contained in the list.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of integers containing a “matrioska sequence”.
If there is an error, returns -1.</p>
</dd>
<dt>Example:</dt><dd><p>A typical output of the function is:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matrioska_interval</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[0, 7, 3, 1, 5, 2, 4, 6]</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The output sequence always start from 0.</p></li>
<li><p>The algorithm is probably not efficient, but for small
number, that is for sizes of simulations (&lt;1000), it can be
OK.  Moreover, it should be called few times (max 3).</p></li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.numpy2hd4Impala">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">numpy2hd4Impala</code><span class="sig-paren">(</span><em class="sig-param">simODS</em>, <em class="sig-param">hd</em>, <em class="sig-param">hd_file</em>, <em class="sig-param">seq=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.numpy2hd4Impala" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a numpy array, prints into an output file all the values in
the hard data file format of <em>Impala</em>.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>This object contains all the dimension required to define a
simulation domain.</p>
</dd>
<dt>hd: numpy array</dt><dd><p>A numpy array containing all the data which to be
converted into hard data. The array contains
<code class="xref py py-data docutils literal notranslate"><span class="pre">no_data</span></code> where there are not conditioning data.</p>
</dd>
<dt>hd_file: string</dt><dd><p>Name of the file where the hard data will be printed.</p>
</dd>
<dt>seq: object type <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a>, optional</dt><dd><p>Some information about the current simulation step. 
If None, then all the <em>informed</em> content of the input
numpy file is saved.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A file containing all the conditioning data required for a given
simulation step in the <em>Impala</em> hard data format.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.numpy2hd4MPDS">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">numpy2hd4MPDS</code><span class="sig-paren">(</span><em class="sig-param">simODS</em>, <em class="sig-param">hd</em>, <em class="sig-param">seq</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.numpy2hd4MPDS" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a numpy array, prints into to a <cite>xyz_data</cite> file to be used
by the function <cite>gslibnumpy.numpy2gslib_points</cite> to create a file
with the conditioning points for the simulation for the MPS code
<cite>MPDS</cite>.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>This object contains all the dimension required to define a
simulation domain.</p>
</dd>
<dt>hd: numpy array</dt><dd><p>A numpy array containing all the data which to be
converted into hard data. The array contains
<code class="xref py py-data docutils literal notranslate"><span class="pre">no_data</span></code> where there are not conditioning data.
seq: object type <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a> Some information
about the current simulation step.</p>
</dd>
</dl>
</dd>
<dt>Returns: </dt><dd><p>A “xyz_data” file (a tuple of numpy arrays) containing the
information about the coordinates and the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.print_result">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">print_result</code><span class="sig-paren">(</span><em class="sig-param">hd</em>, <em class="sig-param">simODS</em>, <em class="sig-param">file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.print_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Print into an ouput file the simulation output.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>hd: numpy array</dt><dd><p>The numpy (3D) array containing all the simulated nodes.</p>
</dd>
<dt>simOSD: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Contains the dimensions of the simulation domain.</p>
</dd>
<dt>file_name: string</dt><dd><p>Name of the output file. The extension can be 
“vtk” or “gslib”.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Create the output file.
If some error occurs, returns -1.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.print_sim_info">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">print_sim_info</code><span class="sig-paren">(</span><em class="sig-param">simODS</em>, <em class="sig-param">par_Xnorm</em>, <em class="sig-param">par_Ynorm</em>, <em class="sig-param">par_Znorm</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.print_sim_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print some information about the parameters of the simulation.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Information about the simulation grid.</p>
</dd>
<dt>par_Xnorm: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Param</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Param</span></code>.</dt><dd><p>Information about the <cite>Impala</cite> parameters normal to the
direction <em>x</em>.  (idem for <em>y</em> and <em>z</em>) and for <cite>MPDS</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.sim_run">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">sim_run</code><span class="sig-paren">(</span><em class="sig-param">seq_steps</em>, <em class="sig-param">step_max</em>, <em class="sig-param">hard_data</em>, <em class="sig-param">simODS</em>, <em class="sig-param">in_par</em>, <em class="sig-param">seed</em>, <em class="sig-param">res_file_root='result'</em>, <em class="sig-param">rcp_lists=False</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.sim_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a <cite>s2Dcd</cite> simulation.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>seq_steps: list object of type <a class="reference internal" href="#s2Dcd.s2Dcd.SeqStep" title="s2Dcd.s2Dcd.SeqStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeqStep</span></code></a></dt><dd><p>A list containing all the information of each simulation step.</p>
</dd>
<dt>step_max: int</dt><dd><p>The maximum simulation step. Note that the simulation
domain can be often filled before this step.</p>
</dd>
<dt>hard_data: numpy array</dt><dd><p>A numpy array containig all the simulation. The value
<code class="xref py py-data docutils literal notranslate"><span class="pre">no_data</span></code> is used in location not simulated.</p>
</dd>
<dt>simODS: object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid</span></code></dt><dd><p>Contains all the info concerning the simulation domain.</p>
</dd>
<dt>in_par: string or a object of type <cite>ds_interface.Param</cite></dt><dd><p>The name of the file containing the template of the input
parameters file for <cite>Impala</cite> or the object containing all
the parameters required for a <cite>MPDS</cite> simulation.</p>
</dd>
<dt>seed: instance of the class <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code></dt><dd><p>To keep track of the random seed and create simulations
that can be reproduced using the same seed.</p>
</dd>
<dt>res_file_root: string</dt><dd><p>The root name of the file containing the output
results. The right extension will be added once defined
the MPS simulation core.</p>
</dd>
<dt>rcp_lists: flag (default False)</dt><dd><p>This flag is useful if one wants to re-compute the list
at each s2Dcd simulation step. When True it is a waste of time
if the TI along the same direction is always the same. It is
only useful when different training images are used for
the simuations along the same direction.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A VTK or a GSLIB file containing the results of the simulation.
If the max number of interation is reached, a result file
containing “no data” values is printed out.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.s2Dcd.split_segms">
<code class="sig-prename descclassname">s2Dcd.s2Dcd.</code><code class="sig-name descname">split_segms</code><span class="sig-paren">(</span><em class="sig-param">segms</em>, <em class="sig-param">mid_list=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.s2Dcd.split_segms" title="Permalink to this definition">¶</a></dt>
<dd><p>A recursive function to print out a “matrioska-like” sequence of
integers.</p>
<dl>
<dt>Parameters</dt><dd><dl class="simple">
<dt>segms<span class="classifier">list of tuples of type (a,b)</span></dt><dd><p>A list containing a number of tuples representing a segment.</p>
</dd>
<dt>mid_list: list of integers, optional</dt><dd><p>The list of integers that represents the required output.
By default this should be called without this argument.</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>A list containing all the integers in the mixed “matrioska” order.</p>
</dd>
<dt>Example</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matrioska_interval</span><span class="p">([(</span><span class="mi">11</span><span class="p">,</span><span class="mi">26</span><span class="p">)])</span>
<span class="go">[11, 26, 18, 14, 22, 12, 16, 20, 24, 13, 15, 17, 19, 21, 23, 25]</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is supposed that the coordinates of the segments are all
integers.</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-s2Dcd.deesse">
<span id="the-s2dcd-deesse-module"></span><h2>The <code class="docutils literal notranslate"><span class="pre">s2Dcd.deesse</span></code> module<a class="headerlink" href="#module-s2Dcd.deesse" title="Permalink to this headline">¶</a></h2>
<dl class="field-list">
<dt class="field-odd">license</dt>
<dd class="field-odd"><p>This file is part of s2Dcd.</p>
<p>s2Dcd is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>s2Dcd is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with s2Dcd.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
</dd>
<dt class="field-even">Purpose</dt>
<dd class="field-even"><p>A collection of classes and functions to interact with the
Multiple Point Direct Sampling code (DeeSse).</p>
</dd>
<dt class="field-odd">File name</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">deesse.py</span></code></p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><dl class="simple">
<dt>0.7 , 2020-01-20 :</dt><dd><ul class="simple">
<li><p>Some clean up before the upload to Github.</p></li>
</ul>
</dd>
<dt>0.6 , 2017-12-15 :</dt><dd><ul class="simple">
<li><p>Adapted to the 2017 vesion of the code (includes “Pyramids” option)</p></li>
<li><p>Partially takes the comments for the .in file from an
external .json file.</p></li>
</ul>
</dd>
<dt>0.5 , 2015-10-15 :</dt><dd><ul class="simple">
<li><p>Extending to deal with multiple variables simulation.</p></li>
</ul>
</dd>
<dt>0.4 , 2013-06-17 :</dt><dd><ul class="simple">
<li><p>Some small modifications to make the setting of the default values
more coherent.</p></li>
</ul>
</dd>
<dt>0.3 , 2013-03-13 :</dt><dd><ul class="simple">
<li><p>Moved to Python3 using <cite>2to3</cite>.</p></li>
</ul>
</dd>
<dt>0.2 , 2012-07-30 :</dt><dd><ul class="simple">
<li><p>Moved the function <cite>skip_ccomments</cite> to the module <cite>utili.py</cite>.</p></li>
<li><p>Last version before the movement to Python3.</p></li>
</ul>
</dd>
<dt>0.1 , 2012-03-30 :</dt><dd><p>First version.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Alessandro Comunian</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>A <cite>deesse_file_in_text.json</cite> is required and contains all comment text
that put in the deesse <cite>.in</cite> file. To create easily a <cite>.json</cite> file that
respects the intendation and the new lines of the original <cite>.in</cite> file,
you can use something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gawk</span> <span class="s1">&#39;$1=$0&#39;</span> <span class="n">ORS</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="n">file</span><span class="o">.</span><span class="ow">in</span>
</pre></div>
</div>
<p>to replace all the new lines by n, at the same time keeping the
original indentation of the file.</p>
</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>The coverage and the support of the simulation options provided
by DS simulation engine is only partial.</p></li>
</ul>
</div>
<dl class="class">
<dt id="s2Dcd.deesse.Param">
<em class="property">class </em><code class="sig-prename descclassname">s2Dcd.deesse.</code><code class="sig-name descname">Param</code><span class="sig-paren">(</span><em class="sig-param">file_name=None, gridin=&lt;s2Dcd.grid.Grid object&gt;, var_nb=1, vars=[&lt;s2Dcd.deesse.VarInfo object&gt;], out_set='OUTPUT_SIM_ALL_IN_ONE_FILE', out_file='test_simul.gslib', out_report=True, out_report_file='test_report.txt', ti_nb=1, data_img_nb=0, data_img_files=[], data_pointset_nb=0, data_pointset_files=[], mask=False, homot_usage=0, rot_usage=0, cond_data_tol=0.05, norm_type='NORMALIZING_LINEAR', sim_type='SIM_ONE_BY_ONE', sim_path='PATH_RANDOM', tol=0.0, post_proc_path_max=1, post_proc_par='POST_PROCESSING_PARAMETERS_DEFAULT', pyramids=0, seed=444, seed_inc=1, real_nb=1</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param" title="Permalink to this definition">¶</a></dt>
<dd><p>A class containing all the parameters contained in the parameters file.</p>
<dl class="method">
<dt id="s2Dcd.deesse.Param.print_blockdata">
<code class="sig-name descname">print_blockdata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_blockdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info related to the BLOCK_DATA option</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_blockdata_intro">
<code class="sig-name descname">print_blockdata_intro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_blockdata_intro" title="Permalink to this definition">¶</a></dt>
<dd><p>Print some introductory text to the 
parameters related to the block data option</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Probability constraints are still not implemented in 
this version of the DeeSse interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_consi">
<code class="sig-name descname">print_consi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_consi" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the consistency</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_difile">
<code class="sig-name descname">print_difile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_difile" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the content of the data image file</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_distthr">
<code class="sig-name descname">print_distthr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_distthr" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the distance threshold</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_disttype">
<code class="sig-name descname">print_disttype</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_disttype" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info related to the distance type</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_dpset">
<code class="sig-name descname">print_dpset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_dpset" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info related to the data point set</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_file">
<code class="sig-name descname">print_file</code><span class="sig-paren">(</span><em class="sig-param">file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the content of the parameters object into a file.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_name: string</dt><dd><p>Name of the file where to print.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_homo">
<code class="sig-name descname">print_homo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_homo" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the homothety</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_maskimage">
<code class="sig-name descname">print_maskimage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_maskimage" title="Permalink to this definition">¶</a></dt>
<dd><p>Print infor related to the mask image</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_max_dens">
<code class="sig-name descname">print_max_dens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_max_dens" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the max density of nodes</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_max_nod">
<code class="sig-name descname">print_max_nod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_max_nod" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the max number of neighborihg nodes</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_maxscan">
<code class="sig-name descname">print_maxscan</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_maxscan" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the percentage of image to scan</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_neigh_intro">
<code class="sig-name descname">print_neigh_intro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_neigh_intro" title="Permalink to this definition">¶</a></dt>
<dd><p>Print some introductory text to the 
parameters related to the search neighborhood</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_neighs">
<code class="sig-name descname">print_neighs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_neighs" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info related to the search neighborhood</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_norm">
<code class="sig-name descname">print_norm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the normalization</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_out_report">
<code class="sig-name descname">print_out_report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_out_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the output report</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_out_set">
<code class="sig-name descname">print_out_set</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_out_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the output settings</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_post">
<code class="sig-name descname">print_post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info related to the post-processing procedure</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_proconst">
<code class="sig-name descname">print_proconst</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_proconst" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info related to the probability constraints</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_proconst_intro">
<code class="sig-name descname">print_proconst_intro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_proconst_intro" title="Permalink to this definition">¶</a></dt>
<dd><p>Print some introductory text to the 
parameters related to the probability constraints</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Probability constraints are still not implemented in 
this version of the DeeSse interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_pyramids">
<code class="sig-name descname">print_pyramids</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_pyramids" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info related to the pyramids procedure</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_realnb">
<code class="sig-name descname">print_realnb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_realnb" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the number of realizations</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_reldist">
<code class="sig-name descname">print_reldist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_reldist" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info relative to the relative distance</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_rot">
<code class="sig-name descname">print_rot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_rot" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the rotation</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_seed">
<code class="sig-name descname">print_seed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the seed</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_sim_grid">
<code class="sig-name descname">print_sim_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_sim_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the simulation grid info</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_sim_var">
<code class="sig-name descname">print_sim_var</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_sim_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the simulation variables info</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_simpath">
<code class="sig-name descname">print_simpath</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_simpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the simulation and the path</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_ti">
<code class="sig-name descname">print_ti</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_ti" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the TI info</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_tol">
<code class="sig-name descname">print_tol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_tol" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the tolerance</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.deesse.Param.print_weight">
<code class="sig-name descname">print_weight</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.Param.print_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the weighting factors</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="s2Dcd.deesse.TiInfo">
<em class="property">class </em><code class="sig-prename descclassname">s2Dcd.deesse.</code><code class="sig-name descname">TiInfo</code><span class="sig-paren">(</span><em class="sig-param">file_name='ti.gslib'</em>, <em class="sig-param">max_scan=0.3</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.TiInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to support the class ParamMPDS. Contains all the information
related to one training image.</p>
<dl class="simple">
<dt>Main attributes:</dt><dd><dl class="simple">
<dt>file_name: string</dt><dd><p>Name of the file containing the training image</p>
</dd>
<dt>max_scan: float</dt><dd><p>Fraction of the TI to scan</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="s2Dcd.deesse.VarInfo">
<em class="property">class </em><code class="sig-prename descclassname">s2Dcd.deesse.</code><code class="sig-name descname">VarInfo</code><span class="sig-paren">(</span><em class="sig-param">name='facies'</em>, <em class="sig-param">out_flag=True</em>, <em class="sig-param">fmt='%10.5E'</em>, <em class="sig-param">search_r_x=120.0</em>, <em class="sig-param">search_r_y=120.0</em>, <em class="sig-param">search_r_z=0.0</em>, <em class="sig-param">search_anis_x=1.0</em>, <em class="sig-param">search_anis_y=1.0</em>, <em class="sig-param">search_anis_z=1.0</em>, <em class="sig-param">search_ang_az=0.0</em>, <em class="sig-param">search_ang_dp=0.0</em>, <em class="sig-param">search_ang_pl=0.0</em>, <em class="sig-param">search_pow=0.0</em>, <em class="sig-param">max_nb_neigh=20</em>, <em class="sig-param">max_dens_neigh=1.0</em>, <em class="sig-param">rel_dist_flag=0</em>, <em class="sig-param">dist_type=0</em>, <em class="sig-param">weight=1.0</em>, <em class="sig-param">dist_thre=0.01</em>, <em class="sig-param">prob_constr=0</em>, <em class="sig-param">block_data=0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.deesse.VarInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to support the class ParamMPDS. It tries to regroup all
the information about a variable which have to be simulated.</p>
</dd></dl>

</div>
<div class="section" id="module-s2Dcd.utili">
<span id="the-s2dcd-utili-module"></span><h2>The <code class="docutils literal notranslate"><span class="pre">s2Dcd.utili</span></code> module<a class="headerlink" href="#module-s2Dcd.utili" title="Permalink to this headline">¶</a></h2>
<dl class="field-list">
<dt class="field-odd">license</dt>
<dd class="field-odd"><p>This file is part of s2Dcd.</p>
<p>s2Dcd is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>s2Dcd is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with s2Dcd.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
</dd>
<dt class="field-even">this file</dt>
<dd class="field-even"><p><cite>utili.py</cite></p>
</dd>
<dt class="field-odd">Purpose</dt>
<dd class="field-odd"><p>A collection of small utility functions</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><ul class="simple">
<li><dl class="simple">
<dt>0.6 , 2017-12-15 :</dt><dd><ul>
<li><p>Improved the way computing time is computed by using
<code class="docutils literal notranslate"><span class="pre">time.perf_counter()</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>0.5 , 2015-12-03 :</dt><dd><ul>
<li><p>Some minor cleanup</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>0.4 , 2013-03-06 :</dt><dd><ul>
<li><p>Converted to Python3.X</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>0.3 , 2013-03-06 :</dt><dd><ul>
<li><p>Last version before the conversion to python3.X</p></li>
<li><p>Added a function to skip the C-like comments.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>0.2 , 2012-05-02 :</dt><dd><ul>
<li><p>Added a function usefult for the output print…</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>0.1 , 2012-03-09 :</dt><dd><ul>
<li><p>First version.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Alessandro Comunian</p>
</dd>
</dl>
<dl class="function">
<dt id="s2Dcd.utili.add_file_id">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">add_file_id</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">file_id</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.add_file_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a file ID to a file name, given an int ID.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_name: string</dt><dd><p>The name of the file (with extension…)</p>
</dd>
<dt>file_id: int</dt><dd><p>The ID which is associated to the file name</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.utili.dtype_fmt">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">dtype_fmt</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.dtype_fmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a printing format according to the type of the input numpy
array.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>x: numpy array</p>
</dd>
<dt>Returns:</dt><dd><p>A string that defines the output format that should be used for the
formatted output, that is ‘%d’ is the case of an integer, and
‘%.4e’ in case of a float.
In case of an error, returs -1.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.utili.print_start">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">print_start</code><span class="sig-paren">(</span><em class="sig-param">title=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.print_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the “begin” header and start counting time…</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>title: string, optional</dt><dd><p>A message to be printed in a “formatted stype”. If a
string is not provided, then use the name of the calling
script.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>The output of the function <cite>time.clock()</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.utili.print_stop">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">print_stop</code><span class="sig-paren">(</span><em class="sig-param">time_start=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.print_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the “end” message and the computing time.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>time_start: ouput of the function <a class="reference internal" href="#s2Dcd.utili.print_start" title="s2Dcd.utili.print_start"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_start()</span></code></a>, optional</dt><dd><p>The function should be called in conjunction with the
function <cite>print_start</cite>. If a value for time_start is not
provided, then simply print out the current time and the
stop message.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Print out the computing time</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.utili.progress_bar">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">progress_bar</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">nb_steps</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.progress_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple progress bar</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>i: integer</dt><dd><p>The current index</p>
</dd>
<dt>nb_steps:</dt><dd><p>The total number of steps</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.utili.progress_bar_end">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">progress_bar_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.progress_bar_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the end of the progress bar</p>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.utili.savepdf">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">savepdf</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">title=''</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.savepdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a matplotlib figure as PDF and set up some useful information as
metadata in the PDF file.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>The name of the PDF file.</p>
</dd>
<dt>title<span class="classifier">string, optional</span></dt><dd><p>The title of the PDF document.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A PDF file containing the figure with the selected metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.utili.skip_ccomments">
<code class="sig-prename descclassname">s2Dcd.utili.</code><code class="sig-name descname">skip_ccomments</code><span class="sig-paren">(</span><em class="sig-param">par_file</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.utili.skip_ccomments" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the connection to a file and extract a list containing all
the fields, excluding line commenten in a <em>C-like</em> style, that is
starting with “//” or enclosed by “/<em>…</em>/”.</p>
<dl class="simple">
<dt>Parameters</dt><dd><dl class="simple">
<dt>file: file object</dt><dd><p>The file to be read.</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>A list containing all the strings (the parameters), separated
by a space.  Of course, the structure of the list depends on
the structure of the paramters file.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the moment only the space characters are considered as field
separators. All the fields in the list are returned as strings,
therefore you will have to “cast” them according to your needs.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The comments at the end of a line containing parameters are
not deleted. Therefore, used should be aware about what they
are reading on each line…</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-s2Dcd.grid">
<span id="the-s2dcd-grid-module"></span><h2>The <code class="docutils literal notranslate"><span class="pre">s2Dcd.grid</span></code> module<a class="headerlink" href="#module-s2Dcd.grid" title="Permalink to this headline">¶</a></h2>
<dl class="field-list">
<dt class="field-odd">license</dt>
<dd class="field-odd"><p>This file is part of s2Dcd.</p>
<p>s2Dcd is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>s2Dcd is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with s2Dcd.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
</dd>
<dt class="field-even">Purpose</dt>
<dd class="field-even"><p>A module containing some classes and function useful to work with
structured grids.</p>
</dd>
<dt class="field-odd">This file</dt>
<dd class="field-odd"><p><cite>grid.py</cite></p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><dl class="simple">
<dt>0.3 , 2013-08-11 :</dt><dd><ul class="simple">
<li><p>Adapted to the case of grids made of cells or grid made of
points.</p></li>
</ul>
</dd>
<dt>0.2 , 2013-03-06 :</dt><dd><ul class="simple">
<li><p>Converted to Python3.X with <cite>2to3</cite></p></li>
</ul>
</dd>
<dt>0.1 , 2012-04-02 :</dt><dd><ul class="simple">
<li><p>First version.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Alessandro Comunian</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The grids for the moment are always considered as 3D.</p>
</div>
<dl class="class">
<dt id="s2Dcd.grid.Grid">
<em class="property">class </em><code class="sig-prename descclassname">s2Dcd.grid.</code><code class="sig-name descname">Grid</code><span class="sig-paren">(</span><em class="sig-param">ox=0.0</em>, <em class="sig-param">oy=0.0</em>, <em class="sig-param">oz=0.0</em>, <em class="sig-param">dx=1.0</em>, <em class="sig-param">dy=1.0</em>, <em class="sig-param">dz=1.0</em>, <em class="sig-param">nx=200</em>, <em class="sig-param">ny=200</em>, <em class="sig-param">nz=1</em>, <em class="sig-param">gtype='points'</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple class that contains the <em>Origin</em>, <em>Delta</em> and <em>Size</em> of a
simulation.  It can also be used as container for some information
contained in a VTK structured grid file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>By default, the size of the grid is considered in term of points.</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">vtknumpy</span></code></p>
</div>
<dl class="method">
<dt id="s2Dcd.grid.Grid.cells">
<em class="property">property </em><code class="sig-name descname">cells</code><a class="headerlink" href="#s2Dcd.grid.Grid.cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of cells</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.compute_max">
<code class="sig-name descname">compute_max</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.compute_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the max values for <em>x</em>, <em>y</em> and <em>z</em> of the grid.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.get_cells">
<code class="sig-name descname">get_cells</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.get_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the number of cells for a cells grid</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.get_center">
<code class="sig-name descname">get_center</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.get_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the center of the grid</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.get_lx">
<code class="sig-name descname">get_lx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.get_lx" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide as output a tuple containing the size of a
grid. Useful for the implementation of <code class="docutils literal notranslate"><span class="pre">property</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.get_ly">
<code class="sig-name descname">get_ly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.get_ly" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide as output a tuple containing the size of a
grid. Useful for the implementation of <code class="docutils literal notranslate"><span class="pre">property</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.get_lz">
<code class="sig-name descname">get_lz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.get_lz" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide as output a tuple containing the size of a
grid. Useful for the implementation of <code class="docutils literal notranslate"><span class="pre">property</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.get_points">
<code class="sig-name descname">get_points</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.get_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the number of points for a points grid</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.get_size">
<code class="sig-name descname">get_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total number of points/cells in the grid.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.lx">
<em class="property">property </em><code class="sig-name descname">lx</code><a class="headerlink" href="#s2Dcd.grid.Grid.lx" title="Permalink to this definition">¶</a></dt>
<dd><p>‘size’ along <em>x</em> of the grid.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.ly">
<em class="property">property </em><code class="sig-name descname">ly</code><a class="headerlink" href="#s2Dcd.grid.Grid.ly" title="Permalink to this definition">¶</a></dt>
<dd><p>‘size’ along <em>y</em> of the grid.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.lz">
<em class="property">property </em><code class="sig-name descname">lz</code><a class="headerlink" href="#s2Dcd.grid.Grid.lz" title="Permalink to this definition">¶</a></dt>
<dd><p>‘size’ along <em>z</em> of the grid.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.origin">
<code class="sig-name descname">origin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.origin" title="Permalink to this definition">¶</a></dt>
<dd><p>To print out the origin of the grid as a tuple</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>self : an instance of the Grid class</p>
</dd>
<dt>Returns:</dt><dd><p>A tuple containing the origin defined in the grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.points">
<em class="property">property </em><code class="sig-name descname">points</code><a class="headerlink" href="#s2Dcd.grid.Grid.points" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.print4gslib">
<code class="sig-name descname">print4gslib</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.print4gslib" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to print out the grid information in the header of
a GSLIB file.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.print_intervals">
<code class="sig-name descname">print_intervals</code><span class="sig-paren">(</span><em class="sig-param">axis='xyz'</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.print_intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the intervals that constitute the simulation domain in a
format like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">ox</span><span class="p">,</span> <span class="n">ox</span><span class="o">+</span><span class="n">nx</span><span class="o">*</span><span class="n">dx</span><span class="p">]</span> <span class="p">[</span> <span class="n">oy</span><span class="p">,</span> <span class="n">oy</span><span class="o">+</span><span class="n">ny</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span> <span class="p">[</span> <span class="n">oz</span><span class="p">,</span> <span class="n">oz</span><span class="o">+</span><span class="n">nz</span><span class="o">*</span><span class="n">dz</span><span class="p">]</span>
</pre></div>
</div>
<p>where <em>ox</em> is the origin, <em>nx</em> is the number of points and <em>dx</em>
is the delta between points (<em>idem</em> for <em>y</em> and <em>z</em>).</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>axis: string containing [‘x’,’y’,’z’], optional</dt><dd><p>If the default value “xyz” is used, then all the intevals
are printed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.shape">
<code class="sig-name descname">shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>To print out the shape of the grid as a tuple</p>
<p>Parameters:</p>
<blockquote>
<div><p>self:</p>
<blockquote>
<div><p>an instance of the Grid class</p>
</div></blockquote>
<p>gtype: string in (‘points’, ‘cells’)</p>
<blockquote>
<div><p>String to decide to print the shape in terms of points
or in terms of cells.</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>A tuple containing the origin defined in the grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.grid.Grid.spacing">
<code class="sig-name descname">spacing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.Grid.spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>To print out the spacing of the grid as a tuple</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>self : an instance of the Grid class</p>
</dd>
<dt>Returns:</dt><dd><p>A tuple  containing the spacing defined in the grid.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="s2Dcd.grid.sg_info">
<code class="sig-prename descclassname">s2Dcd.grid.</code><code class="sig-name descname">sg_info</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.grid.sg_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect some information about a structured grid
contained in a numpy array</p>
</dd></dl>

</div>
<div class="section" id="module-s2Dcd.gslibnumpy">
<span id="the-s2dcd-gslibnumpy-module"></span><h2>The <code class="docutils literal notranslate"><span class="pre">s2Dcd.gslibnumpy</span></code> module<a class="headerlink" href="#module-s2Dcd.gslibnumpy" title="Permalink to this headline">¶</a></h2>
<dl class="field-list">
<dt class="field-odd">license</dt>
<dd class="field-odd"><p>This file is part of s2Dcd.</p>
<p>s2Dcd is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>s2Dcd is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with s2Dcd.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
</dd>
<dt class="field-even">Purpose</dt>
<dd class="field-even"><p>A module with some utilities to convert from numpy to gslib and
vice-versa, and to support some GSLIB based software.</p>
<p>For more details about the GSLIB software, see <a class="reference internal" href="#deutsch1988" id="id5"><span>[Deutsch1988]</span></a> .</p>
</dd>
<dt class="field-odd">This file</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">gslibnumpy.py</span></code></p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><dl class="simple">
<dt>0.9 , 2020-01-20 :</dt><dd><ul class="simple">
<li><p>Adapted to the inclusion in the s2Dcd package on Github.</p></li>
</ul>
</dd>
<dt>0.8 , 2015-12-02 :</dt><dd><ul class="simple">
<li><p>Added <cite>gslib_slice</cite>.</p></li>
<li><p>General clean-up</p></li>
<li><p>Improved numpy2gslib to allow printing many variables</p></li>
<li><p>Improved the pandas usage in numpy2gslib</p></li>
</ul>
</dd>
<dt>0.7 , 2014-11-13 :</dt><dd><ul class="simple">
<li><p>Introduced dependencies from “pandas” to load txt faster</p></li>
</ul>
</dd>
<dt>0.6 , 2013-08-26 :</dt><dd><ul class="simple">
<li><p>Improved how errors are handled in <cite>gslib2numpy</cite> and the
extension available.</p></li>
</ul>
</dd>
<dt>0.5 , 2013-07-07 :</dt><dd><ul class="simple">
<li><p>Improved the function <cite>gslib_points2numpy</cite>.</p></li>
</ul>
</dd>
<dt>0.4 , 2013-03-06 :</dt><dd><ul class="simple">
<li><p>Converted to Python3 using <cite>2to3</cite>.</p></li>
<li><p>Improved the flexibility of <cite>gslib2numpy</cite>.</p></li>
<li><p>Remover the dependence from the module <cite>gslibnumpy_f</cite>.</p></li>
</ul>
</dd>
<dt>0.3 , 2012-11-19 :</dt><dd><ul class="simple">
<li><p>Last version before the conversion to Python3.</p></li>
<li><p>Module <cite>gslib2numpy</cite> improved to be able to read also files
containing multiple variables.</p></li>
<li><p>merged the function <cite>dat2numpy</cite> into <cite>gslib2numpy</cite>.</p></li>
</ul>
</dd>
<dt>0.2 , 2012-11-18 :</dt><dd><ul class="simple">
<li><p>Some improvement using the suggestions of Spyder.</p></li>
<li><p>Deleted the option for the “dtype” in function
“gslib_points2numpy”.</p></li>
<li><p>included a new function to load GSLIB files coming from Isatis
(dat2numpy, for files <code class="docutils literal notranslate"><span class="pre">.dat</span></code>)</p></li>
</ul>
</dd>
<dt>0.1 , 2012-04-27 :</dt><dd><ul class="simple">
<li><p>Implemented in FORTRAN90 the subroutines <cite>numpy2gslib</cite>.</p></li>
</ul>
</dd>
<dt>0.0 , 2012-03-07:</dt><dd><ul class="simple">
<li><p>First version.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Alessandro Comunian</p>
</dd>
</dl>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<dl class="citation">
<dt class="label" id="deutsch1988"><span class="brackets"><a class="fn-backref" href="#id5">Deutsch1988</a></span></dt>
<dd><p>Deutsch, C. V. &amp; Journel, A.G. (1988) GSLIB:
Geostatistical Software Library and User’s Guide 2nd
edition. Oxford University Press</p>
</dd>
</dl>
</div>
<div class="section" id="functions-and-classes">
<h3>Functions and classes<a class="headerlink" href="#functions-and-classes" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="s2Dcd.gslibnumpy.VarioStruct">
<em class="property">class </em><code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">VarioStruct</code><span class="sig-paren">(</span><em class="sig-param">stype=1, c_par=1.0, angles=[0.0, 0.0, 0.0], ranges=[100.0, 100.0, 100.0]</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.VarioStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to contain info about one structure of a variogram</p>
<dl class="method">
<dt id="s2Dcd.gslibnumpy.VarioStruct.print4csv">
<code class="sig-name descname">print4csv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.VarioStruct.print4csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a string with the information contained in the class
useful in a CSV file.</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.gslibnumpy.VarioStruct.print4par">
<code class="sig-name descname">print4par</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.VarioStruct.print4par" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a string with the information contained in the class
useful in a parameter file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="s2Dcd.gslibnumpy.Variogram">
<em class="property">class </em><code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">Variogram</code><span class="sig-paren">(</span><em class="sig-param">str_nb=1</em>, <em class="sig-param">nugget=0.0</em>, <em class="sig-param">cat_thr=0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.Variogram" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to contain all the parameters related to a GSLIB variogram
model.</p>
<dl class="method">
<dt id="s2Dcd.gslibnumpy.Variogram.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">h_max=200.0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.Variogram.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the variogram model using matplotlib</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>h_max: float</dt><dd><p>Maximum value of the lag</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.gslibnumpy.Variogram.plot_3dir">
<code class="sig-name descname">plot_3dir</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">h_max=None</em>, <em class="sig-param">suptitle=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.Variogram.plot_3dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the variogram model using matplotlib along all the three
direction for all the available ranges.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>h_max: float</dt><dd><p>Maximum value of the lag</p>
</dd>
<dt>suptitle: string</dt><dd><p>A string for the super-title.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use by default the range of the 1st structure to define the 
upper limit of the <span class="math notranslate nohighlight">\(x\)</span> axis.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.gslibnumpy.Variogram.print4csv">
<code class="sig-name descname">print4csv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.Variogram.print4csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the info about a variogram for a CSV file</p>
</dd></dl>

<dl class="method">
<dt id="s2Dcd.gslibnumpy.Variogram.print4par">
<code class="sig-name descname">print4par</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.Variogram.print4par" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the info about a variogram for a parameter file</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.align_parfile">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">align_parfile</code><span class="sig-paren">(</span><em class="sig-param">par_file</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.align_parfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a string as a parfile, detect where the character “” is and
align everything.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>par_file: string</dt><dd><p>A string containing the parameter file to be indented.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A string containing the parameter file indented.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.exponential">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">exponential</code><span class="sig-paren">(</span><em class="sig-param">h</em>, <em class="sig-param">c=1.0</em>, <em class="sig-param">a=100.0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.exponential" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition of the model of a Exponential variogram.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>h: float</dt><dd><p>The values of lag <span class="math notranslate nohighlight">\(h\)</span> where to plot the variogram</p>
</dd>
<dt>c: float</dt><dd><p>The sill value <span class="math notranslate nohighlight">\(c\)</span></p>
</dd>
<dt>a: float</dt><dd><p>The actual range <span class="math notranslate nohighlight">\(a\)</span></p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>The values of the variogram <span class="math notranslate nohighlight">\(\gamma(h)\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.gaussian">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">gaussian</code><span class="sig-paren">(</span><em class="sig-param">h</em>, <em class="sig-param">c=1.0</em>, <em class="sig-param">a=100.0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition of the model of a Gaussian variogram.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>h: float</dt><dd><p>The values of lag <span class="math notranslate nohighlight">\(h\)</span> where to plot the variogram</p>
</dd>
<dt>c: float</dt><dd><p>The sill value <span class="math notranslate nohighlight">\(c\)</span></p>
</dd>
<dt>a: float</dt><dd><p>The actual range <span class="math notranslate nohighlight">\(a\)</span></p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>The values of the variogram <span class="math notranslate nohighlight">\(\gamma(h)\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.gslib2numpy">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">gslib2numpy</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">formats=None</em>, <em class="sig-param">names=None</em>, <em class="sig-param">source=None</em>, <em class="sig-param">grd=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.gslib2numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a GSLIB ASCII grid into a numpy array.</p>
<p>Can convert only a subclass of GSLIB ASCII files.
See note for more details.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_name: string</dt><dd><p>Name of the GSLIB input file.</p>
</dd>
<dt>verbose: bool, optional</dt><dd><p>A flag to print reading information or not.</p>
</dd>
<dt>formats: list of characters, optional (default=None)</dt><dd><p>The definition of the input format, <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.genfromtxt()</span></code>
like.
If nothing is provided, float values are considered for each
variable.</p>
</dd>
<dt>names: tuple, optional (default=None)</dt><dd><p>The definition of the names of the variables. If not
provided, the names of the variables contained in the
GSLIB file are used.</p>
</dd>
<dt>source: string in [‘impala’,’isatis’, ‘fluvsim’],</dt><dd><p>optional (default=None)
The header changes a little if the file is to be used with
“impala”, or it is an output from “isatis”.  The functions
tries to extrapolate from the file extension if the file
comes from “impala” (.gslib) or from “Isatis” (.dat).  If
this argument is provided, then the format of the header
is forced according to this (see the note for more
details).  The output files from FLUVSIM (.out) have a
header that contains only the dimensions of the grid, and
therefore they fall as a simple case of “implala” files.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>out_dict:</dt><dd><p>A numpy dictionary of arrays with the data contained in
the GSLIB file.</p>
</dd>
<dt>in_grd:</dt><dd><p>A “grid.Grid” object, containing the grid definition (if
provided).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Limited to a subsclass of GSLIB ASCII files.
The files can have an “impala” (of FLUVSIM) format, like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span> <span class="n">ny</span> <span class="n">nz</span> <span class="p">[</span> <span class="n">dx</span> <span class="n">dy</span> <span class="n">dz</span> <span class="p">[</span> <span class="n">ox</span> <span class="n">oy</span> <span class="n">oz</span><span class="p">]</span> <span class="p">]</span>
<span class="n">nb_var</span>
<span class="n">var_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">var_name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">var_name</span><span class="p">[</span><span class="n">nb_var</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">var0_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="n">var1_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">...</span>
<span class="n">var0_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">var1_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">...</span>
<span class="o">...</span>           <span class="o">...</span>           <span class="o">...</span>
</pre></div>
</div>
<p>Or, in case the software is “Isatis”, then the header will be
like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Description</span> <span class="n">line</span>
<span class="n">nb_var</span> <span class="n">nx</span> <span class="n">ny</span> <span class="n">nz</span> <span class="n">ox</span> <span class="n">oy</span> <span class="n">oz</span> <span class="n">dx</span> <span class="n">dy</span> <span class="n">dz</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.genfromtxt()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.gslib2numpy_onevar">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">gslib2numpy_onevar</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">formats=None</em>, <em class="sig-param">names=None</em>, <em class="sig-param">source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.gslib2numpy_onevar" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a GSLIB ASCII grid into a numpy array.</p>
<p>This is a simplified version of <code class="docutils literal notranslate"><span class="pre">gslib2numpy</span></code> that can be used
when you only have one variable and you don’t care about the grid
information contained in the file.</p>
<p>Can convert only a subclass of GSLIB ASCII files.
See note for more details.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_name: string</dt><dd><p>Name of the GSLIB input file.</p>
</dd>
<dt>verbose: bool, optional</dt><dd><p>A flag to print reading information or not.</p>
</dd>
<dt>formats: list of characters, optional (default=None)</dt><dd><p>The definition of the input format, <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.genfromtxt()</span></code>
like.
If nothing is provided, float values are considered for each
variable.</p>
</dd>
<dt>names: tuple, optional (default=None)</dt><dd><p>The definition of the names of the variables. If not provided,
the names of the variables contained in the GSLIB file are used.</p>
</dd>
<dt>source: string in [‘impala’,’isatis’], optional (default=None)</dt><dd><p>The header changes a little if the file is to be used with 
“impala”, or it is an output from “isatis”.
The functions tries to extrapolate from the file extension if
the file comes from “impala” (<em>.gslib) or from “Isatis” (</em>.dat).
If this argument is provided, then the format of the header is
forced according to this (see the note for more details).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>out_dict:</dt><dd><p>A numpy dictionary of arrays with the data contained in
the GSLIB file.  NON NON …. ONLY A VARIABLE! UPDATE THIS
DOCUMENTATION IF IT WORKS.</p>
</dd>
<dt>in_grd:</dt><dd><p>A “grid.Grid” object, containing the grid definition (if
provided).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Limited to a subsclass of GSLIB ASCII files.
The files can have an “impala” format, like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span> <span class="n">ny</span> <span class="n">nz</span> <span class="p">[</span> <span class="n">dx</span> <span class="n">dy</span> <span class="n">dz</span> <span class="p">[</span> <span class="n">ox</span> <span class="n">oy</span> <span class="n">oz</span><span class="p">]</span> <span class="p">]</span>
<span class="n">nb_var</span>
<span class="n">var_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">var_name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">var_name</span><span class="p">[</span><span class="n">nb_var</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">var0_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="n">var1_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">...</span>
<span class="n">var0_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">var1_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">...</span>
<span class="o">...</span>           <span class="o">...</span>           <span class="o">...</span>
</pre></div>
</div>
<p>Or, in case the software is “Isatis”, then the header will be like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Description</span> <span class="n">line</span>
<span class="n">nb_var</span> <span class="n">nx</span> <span class="n">ny</span> <span class="n">nz</span> <span class="n">ox</span> <span class="n">oy</span> <span class="n">oz</span> <span class="n">dx</span> <span class="n">dy</span> <span class="n">dz</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.genfromtxt()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.gslib_points2numpy">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">gslib_points2numpy</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">formats=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.gslib_points2numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to a GSLIB ASCII point data file into a numpy array.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_name<span class="classifier">string</span></dt><dd><p>Name of the GSLIB input file.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>A flag to print out information or not.</p>
</dd>
<dt>formats: list of characters, optional (default=None)</dt><dd><p>The definition of the input format,
<code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.genfromtxt()</span></code> like.  If nothing is provided,
then <cite>genfromtxt</cite> tries to understand the format
automatically.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>An <cite>ndarray</cite> containing a key for each variable contained in
the GSLIB file and a string containing the header of the file.</p>
</dd>
<dt>Example:</dt><dd><p>Read the content of the file <cite>test.gslib</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">gslib_points2numpy</span><span class="p">(</span><span class="s2">&quot;test.gslib&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.gslib_slice">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">gslib_slice</code><span class="sig-paren">(</span><em class="sig-param">file_in</em>, <em class="sig-param">axis</em>, <em class="sig-param">level=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.gslib_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut a 2D slice within a 3D <cite>GSLIB</cite> file perpendicular to a given
<em>axis</em> at a given <em>level</em>. The <cite>GSLIB</cite> file can contain more than
one variable.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_in<span class="classifier">string,</span></dt><dd><p>The name of the input file.</p>
</dd>
<dt>axis<span class="classifier">char, in [‘x’, ‘y’, ‘z’]</span></dt><dd><p>The axis coordinate which is used to cut the slice.</p>
</dd>
<dt>level<span class="classifier">int, optional (default=None)</span></dt><dd><p>The index (<strong>not</strong> the true coordinate) along the
coordinate where <cite>axis</cite> is defined where to cut the slice.
If <em>None</em> then an index in the middle of the input
domain is selected.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A file with the same name as <cite>file_in</cite> and a suffix
<cite>-&lt;axis&gt;&lt;level&gt;.gslib</cite> is created, and 0 if successful.
If the return value is &lt; 0 then there was some problem…</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If in the target directory there is a file with the same name as the
file created as return value this is overwritten.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.numpy2dat">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">numpy2dat</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">data</em>, <em class="sig-param">grd=None</em>, <em class="sig-param">varname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.numpy2dat" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a numpy array into a GSLIB ASCII file in the <em>Isatis</em> format.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>file_name<span class="classifier">string</span></dt><dd><p>The name of the GSLIB file where to save the data.</p>
</dd>
<dt>data<span class="classifier">numpy array</span></dt><dd><p>The numpy array to be saved as GSLIB file.</p>
</dd>
<dt>grd<span class="classifier">grid.Grid object, optional</span></dt><dd><p>The definition of the grid for the dataset.</p>
</dd>
<dt>varname<span class="classifier">string, optional</span></dt><dd><p>The name of the variable to be stored in the GSLIB file.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Works only with 1D, 2D or 3D numpy arrays.</p></li>
<li><p>Only one variable per file.</p></li>
<li><p>In some cases the input array must be flatten.</p></li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.numpy2gslib">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">numpy2gslib</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">file_name</em>, <em class="sig-param">var_names=('data'</em>, <em class="sig-param">)</em>, <em class="sig-param">grd=None</em>, <em class="sig-param">float_format=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.numpy2gslib" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a tuple of numpy arrays into a GSLIB ASCII file.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>data<span class="classifier">tuple of numpy arrays</span></dt><dd><p>The numpy arrays to be saved as GSLIB file.</p>
</dd>
<dt>file_name<span class="classifier">string (optional)</span></dt><dd><p>The name of the GSLIB file where to save the data.</p>
</dd>
<dt>varname<span class="classifier">tuple of string, optional</span></dt><dd><p>The names of the variable to be stored in the GSLIB file.
(one for each numpy array in data).</p>
</dd>
<dt>grd<span class="classifier">grid object, optional</span></dt><dd><p>If available, get the dimension of the grid from a grid object.</p>
</dd>
<dt>float_format: string (optional, default None)</dt><dd><p>This is useful to pass to pandas <cite>to_csv</cite> the float format required.</p>
</dd>
<dt>verbose<span class="classifier">boolean flag, optional</span></dt><dd><p>Print or not some info useful for debugging…</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Works only with 1D, 2D or 3D numpy arrays.</p></li>
<li><p>When more than one variable is provided, the order provided
in “var_names” is respected when printing the columns.</p></li>
<li><p><cite>data</cite> should be <strong>always</strong> provided as a tuple, even when
it contains one array only, otherwise it may result in a corrupted
file.</p></li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.numpy2gslib_points">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">numpy2gslib_points</code><span class="sig-paren">(</span><em class="sig-param">xyz_data</em>, <em class="sig-param">file_name</em>, <em class="sig-param">varname='data'</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.numpy2gslib_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a numpy array into a GSLIB points ASCII file.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>xyz_data<span class="classifier">tuple of numpy arrays</span></dt><dd><p>The tuple is made of four numpy arrays of the same lenght:
the coordinates x, y, z and the point data <em>data</em>.
Depending on the size of the tuple, the points are considered
1D, 2D or 3D.</p>
</dd>
<dt>file_name<span class="classifier">string</span></dt><dd><p>The name of the GSLIB file where to save the data.</p>
</dd>
<dt>varname<span class="classifier">string, optional</span></dt><dd><p>The name of the variable.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A gslib point file containing the coordinates of the points
and the data values.  If the size of the input array is &lt;1,
then the value -1 is returned and a warning message is printed
out.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The default names for the variables are <em>x</em>, <em>y</em>, <em>z</em> and <em>data</em>.</p></li>
<li><p>The data type is automatically detected from the data type of the 
data.</p></li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.power">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">power</code><span class="sig-paren">(</span><em class="sig-param">h</em>, <em class="sig-param">c=1.0</em>, <em class="sig-param">omega=1.5</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.power" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition of the model of a power variogram.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>h: float</dt><dd><p>The values of lag <span class="math notranslate nohighlight">\(h\)</span> where to plot the variogram</p>
</dd>
<dt>c: float</dt><dd><p>The sill value <span class="math notranslate nohighlight">\(c\)</span></p>
</dd>
<dt>omega: float</dt><dd><p>The exponent of the model <span class="math notranslate nohighlight">\(\omega\)</span></p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>The values of the variogram <span class="math notranslate nohighlight">\(\gamma(h)\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="s2Dcd.gslibnumpy.spherical">
<code class="sig-prename descclassname">s2Dcd.gslibnumpy.</code><code class="sig-name descname">spherical</code><span class="sig-paren">(</span><em class="sig-param">h</em>, <em class="sig-param">c=1.0</em>, <em class="sig-param">a=100.0</em><span class="sig-paren">)</span><a class="headerlink" href="#s2Dcd.gslibnumpy.spherical" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition of the model of a Spherical variogram.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>h: float</dt><dd><p>The values of lag <span class="math notranslate nohighlight">\(h\)</span> where to plot the variogram</p>
</dd>
<dt>c: float</dt><dd><p>The sill value <span class="math notranslate nohighlight">\(c\)</span></p>
</dd>
<dt>a: float</dt><dd><p>The actual range <span class="math notranslate nohighlight">\(a\)</span></p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>The values of the variogram <span class="math notranslate nohighlight">\(\gamma(h)\)</span></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-s2Dcd.ext">
<span id="the-s2dcd-ext-module"></span><h2>The <code class="docutils literal notranslate"><span class="pre">s2Dcd.ext</span></code> module<a class="headerlink" href="#module-s2Dcd.ext" title="Permalink to this headline">¶</a></h2>
<dl class="field-list">
<dt class="field-odd">license</dt>
<dd class="field-odd"><p>This file is part of s2Dcd.</p>
<p>s2Dcd is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>s2Dcd is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with s2Dcd.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
</dd>
<dt class="field-even">this_file</dt>
<dd class="field-even"><p><cite>ext.py</cite></p>
</dd>
<dt class="field-odd">Purpose</dt>
<dd class="field-odd"><p>A library containing the definition for the extensions for a number
of formats…</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p></p></dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>0.0.2, 2013-02-26 :</dt><dd><p>Added some formats and improved the readibility.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>0.0.1, 2012-05-15 :</dt><dd><p>The first version.</p>
</dd>
</dl>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="licence.html" class="btn btn-neutral float-right" title="Licence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="publications.html" class="btn btn-neutral float-left" title="Publications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Alessandro Comunian

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>